# API测试文档

## 订单模块测试用例

### 1. 创建订单
**接口**: POST /api/order

**前置条件**:
- 用户已登录
- 课程存在且已上架
- 用户未购买过该课程

**测试数据**:
```json
{
  "courseId": 1
}
```

**预期结果**:
- 返回订单号
- 订单状态为"待支付"

### 2. 支付订单
**接口**: PUT /api/order/{orderNo}/pay

**前置条件**:
- 订单存在且状态为"待支付"
- 订单属于当前用户

**预期结果**:
- 订单状态变为"已支付"
- 课程学生数+1
- 记录支付时间

### 3. 重复购买测试
**场景**: 用户购买课程后再次尝试购买

**预期结果**:
- 提示"您已购买过该课程"
- 不允许创建订单

### 4. 并发下单测试
**场景**: 用户快速连续点击购买按钮

**预期结果**:
- 只创建一个订单
- 其他请求提示"订单创建中，请勿重复提交"

### 5. 事务回滚测试
**场景**: 支付过程中系统异常

**预期结果**:
- 订单状态不变
- 课程学生数不变
- 数据一致性保证